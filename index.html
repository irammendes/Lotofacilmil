<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador Lotof√°cil 5.0 - IA LSTM Avan√ßada</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
        }
        .version-badge {
            font-size: 0.8em;
            color: #666;
        }
        .advanced-options, .generate-section {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .prediction-panel {
            background-color: #fff8e1;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }
        .prediction-number {
            display: inline-block;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: #ff9800;
            color: white;
            text-align: center;
            line-height: 28px;
            margin: 3px;
            font-weight: bold;
        }
        .high-probability {
            background-color: #f44336;
        }
        .medium-probability {
            background-color: #ff9800;
        }
        .low-probability {
            background-color: #8bc34a;
        }
        .real-time-badge {
            background-color: #4caf50;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
        .compression-info {
            font-family: monospace;
            background: #f5f5f5;
            padding: 5px;
            border-radius: 4px;
            font-size: 13px;
        }
        footer {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
            color: #666;
        }
        .training-progress {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin: 10px 0;
        }
        .progress-bar {
            height: 20px;
            border-radius: 4px;
            background-color: #4CAF50;
            text-align: center;
            line-height: 20px;
            color: white;
            width: 0%;
        }
        #training-status {
            font-size: 12px;
            color: #666;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.18.0/dist/tf.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Lotof√°cil Generator <span class="version-badge">v5.0 com LSTM</span></h1>
        
        <!-- Se√ß√£o de Sincroniza√ß√£o em Tempo Real -->
        <div class="advanced-options">
            <h3>üîÑ Sincroniza√ß√£o em Tempo Real 
                <span id="connection-status" class="real-time-badge">Conectando...</span>
            </h3>
            <div>
                <input type="checkbox" id="enable-realtime" checked>
                <label for="enable-realtime">Atualiza√ß√µes autom√°ticas</label>
                <div id="last-update" style="font-size:12px; color:#666;"></div>
            </div>
        </div>
        
        <!-- Se√ß√£o de Machine Learning -->
        <div class="prediction-panel">
            <h3>üß† IA LSTM - Predi√ß√£o Avan√ßada</h3>
            <button id="train-model">Treinar Modelo LSTM</button>
            <div class="training-progress">
                <div id="progress-bar" class="progress-bar">0%</div>
            </div>
            <div id="training-status">Modelo n√£o treinado</div>
            
            <button id="analyze-patterns" disabled>Gerar Previs√µes</button>
            <div id="prediction-results" style="margin-top:10px;">
                <p>Probabilidade dos n√∫meros no pr√≥ximo sorteio:</p>
                <div id="predicted-numbers"></div>
                <p style="font-size:12px; color:#666;">*Baseado em an√°lise de padr√µes hist√≥ricos com LSTM</p>
            </div>
        </div>
        
        <!-- Se√ß√£o de Compress√£o -->
        <div class="advanced-options">
            <h3>üóúÔ∏è Otimiza√ß√£o de N√∫meros</h3>
            <div>
                <label for="compression-level">N√≠vel de Compress√£o:</label>
                <select id="compression-level">
                    <option value="low">Baixo</option>
                    <option value="medium">M√©dio</option>
                    <option value="high">Alto</option>
                </select>
                <button id="compress-numbers">Comprimir N√∫meros</button>
                <div id="compression-results" class="compression-info" style="margin-top:10px;"></div>
            </div>
        </div>
        
        <!-- Bot√£o para gerar os n√∫meros -->
        <div class="generate-section">
            <h3>üéüÔ∏è Gerar N√∫meros com IA</h3>
            <button id="generate-ai-numbers" disabled>Gerar N√∫meros com LSTM</button>
            <button id="generate-random-numbers">Gerar N√∫meros Aleat√≥rios</button>
            <div id="lotofacil-numbers" style="margin-top:10px;"></div>
        </div>

        <footer>
            <p>&copy; 2023 Lotof√°cil Generator. Todos os direitos reservados.</p>
        </footer>
    </div>

    <script>
        // Vari√°veis globais
        let lstmModel = null;
        let isModelTrained = false;
        let historicalData = [];
        
        // Fun√ß√£o para gerar dados hist√≥ricos simulados
        function generateHistoricalData() {
            // Geramos 500 sorteios hist√≥ricos simulados
            for (let i = 0; i < 500; i++) {
                let numbers = [];
                while (numbers.length < 15) {
                    let num = Math.floor(Math.random() * 25) + 1;
                    if (!numbers.includes(num)) {
                        numbers.push(num);
                    }
                }
                numbers.sort((a, b) => a - b);
                historicalData.push(numbers);
            }
            
            // Adicionamos alguns padr√µes simples para a LSTM detectar
            // Padr√£o 1: N√∫meros baixos (1-12) s√£o mais comuns nos primeiros 200 sorteios
            for (let i = 0; i < 200; i++) {
                historicalData[i] = historicalData[i].filter(n => n <= 12);
                while (historicalData[i].length < 15) {
                    let num = Math.floor(Math.random() * 12) + 1;
                    if (!historicalData[i].includes(num)) {
                        historicalData[i].push(num);
                    }
                }
                historicalData[i].sort((a, b) => a - b);
            }
            
            // Padr√£o 2: N√∫meros altos (13-25) s√£o mais comuns nos pr√≥ximos 200 sorteios
            for (let i = 200; i < 400; i++) {
                historicalData[i] = historicalData[i].filter(n => n >= 13);
                while (historicalData[i].length < 15) {
                    let num = Math.floor(Math.random() * 13) + 13;
                    if (!historicalData[i].includes(num)) {
                        historicalData[i].push(num);
                    }
                }
                historicalData[i].sort((a, b) => a - b);
            }
            
            // Os √∫ltimos 100 sorteios t√™m uma distribui√ß√£o mais equilibrada
        }
        
        // Fun√ß√£o para preparar os dados para treinamento
        function prepareData() {
            // Convertemos os n√∫meros para um formato one-hot encoding (25 n√∫meros poss√≠veis)
            const sequenceLength = 10; // Usamos 10 sorteios anteriores para prever o pr√≥ximo
            const numNumbers = 25;
            
            const X = [];
            const y = [];
            
            for (let i = sequenceLength; i < historicalData.length; i++) {
                // Pegamos a sequ√™ncia de sorteios anteriores
                const sequence = historicalData.slice(i - sequenceLength, i);
                
                // Convertemos para one-hot encoding
                const encodedSequence = [];
                for (const draw of sequence) {
                    const encodedDraw = new Array(numNumbers).fill(0);
                    for (const num of draw) {
                        encodedDraw[num - 1] = 1; // N√∫meros de 1 a 25
                    }
                    encodedSequence.push(encodedDraw);
                }
                
                X.push(encodedSequence);
                
                // O alvo √© o pr√≥ximo sorteio
                const nextDraw = historicalData[i];
                const encodedNextDraw = new Array(numNumbers).fill(0);
                for (const num of nextDraw) {
                    encodedNextDraw[num - 1] = 1;
                }
                y.push(encodedNextDraw);
            }
            
            return { X: tf.tensor3d(X), y: tf.tensor2d(y) };
        }
        
        // Fun√ß√£o para criar o modelo LSTM
        function createModel() {
            const model = tf.sequential();
            
            // Adicionamos uma camada LSTM
            model.add(tf.layers.lstm({
                units: 64,
                inputShape: [10, 25], // 10 sorteios anteriores, 25 n√∫meros poss√≠veis
                returnSequences: false
            }));
            
            // Adicionamos uma camada densa com ativa√ß√£o sigmoid para prever probabilidades
            model.add(tf.layers.dense({
                units: 25,
                activation: 'sigmoid'
            }));
            
            // Compilamos o modelo
            model.compile({
                optimizer: tf.train.adam(0.01),
                loss: 'binaryCrossentropy',
                metrics: ['accuracy']
            });
            
            return model;
        }
        
        // Fun√ß√£o para treinar o modelo
        async function trainModel() {
            // Geramos dados hist√≥ricos simulados
            generateHistoricalData();
            
            // Preparamos os dados
            const { X, y } = prepareData();
            
            // Criamos o modelo
            lstmModel = createModel();
            
            // Habilitamos os bot√µes de previs√£o
            document.getElementById('analyze-patterns').disabled = false;
            document.getElementById('generate-ai-numbers').disabled = false;
            
            // Treinamos o modelo
            await lstmModel.fit(X, y, {
                epochs: 50,
                batchSize: 32,
                callbacks: {
                    onEpochEnd: async (epoch, logs) => {
                        // Atualizamos a barra de progresso
                        const progress = ((epoch + 1) / 50) * 100;
                        document.getElementById('progress-bar').style.width = `${progress}%`;
                        document.getElementById('progress-bar').innerText = `${Math.round(progress)}%`;
                        
                        // Atualizamos o status
                        document.getElementById('training-status').innerText = 
                            `√âpoca ${epoch + 1}/50 - Loss: ${logs.loss.toFixed(4)} - Accuracy: ${logs.acc.toFixed(4)}`;
                        
                        // Pequeno delay para permitir a atualiza√ß√£o da UI
                        await new Promise(resolve => setTimeout(resolve, 50));
                    }
                }
            });
            
            // Atualizamos o status final
            document.getElementById('training-status').innerText = 'Modelo treinado com sucesso!';
            isModelTrained = true;
            
            // Liberamos a mem√≥ria
            X.dispose();
            y.dispose();
        }
        
        // Fun√ß√£o para fazer previs√µes com o modelo treinado
        async function predictWithModel() {
            if (!isModelTrained) {
                alert('Por favor, treine o modelo primeiro!');
                return;
            }
            
            // Pegamos os √∫ltimos 10 sorteios
            const last10Draws = historicalData.slice(-10);
            
            // Preparamos os dados para predi√ß√£o
            const inputData = [];
            for (const draw of last10Draws) {
                const encodedDraw = new Array(25).fill(0);
                for (const num of draw) {
                    encodedDraw[num - 1] = 1;
                }
                inputData.push(encodedDraw);
            }
            
            // Criamos o tensor de entrada
            const inputTensor = tf.tensor3d([inputData]);
            
            // Fazemos a predi√ß√£o
            const prediction = lstmModel.predict(inputTensor);
            const predictionData = await prediction.data();
            
            // Processamos os resultados
            const numberProbabilities = [];
            for (let i = 0; i < 25; i++) {
                numberProbabilities.push({
                    number: i + 1,
                    probability: predictionData[i]
                });
            }
            
            // Ordenamos por probabilidade
            numberProbabilities.sort((a, b) => b.probability - a.probability);
            
            // Exibimos os resultados
            const predictedNumbersElement = document.getElementById('predicted-numbers');
            predictedNumbersElement.innerHTML = '';
            
            // Adicionamos os n√∫meros com cores baseadas na probabilidade
            numberProbabilities.forEach(item => {
                let probClass;
                if (item.probability > 0.7) {
                    probClass = 'high-probability';
                } else if (item.probability > 0.5) {
                    probClass = 'medium-probability';
                } else {
                    probClass = 'low-probability';
                }
                
                const probPercent = (item.probability * 100).toFixed(1);
                predictedNumbersElement.innerHTML += `
                    <span class="prediction-number ${probClass}" title="Probabilidade: ${probPercent}%">
                        ${item.number}
                    </span>
                `;
            });
            
            // Liberamos a mem√≥ria
            inputTensor.dispose();
            prediction.dispose();
            
            return numberProbabilities;
        }
        
        // Fun√ß√£o para gerar n√∫meros usando a IA
        async function generateNumbersWithAI() {
            const numberProbabilities = await predictWithModel();
            
            // Selecionamos os 15 n√∫meros com maior probabilidade
            const topNumbers = numberProbabilities.slice(0, 15).map(item => item.number);
            topNumbers.sort((a, b) => a - b);
            
            document.getElementById('lotofacil-numbers').innerHTML = 
                `N√∫meros gerados pela IA: ${topNumbers.join(', ')}`;
        }
        
        // Fun√ß√£o para gerar n√∫meros aleat√≥rios
        function generateRandomNumbers() {
            let numbers = [];
            while (numbers.length < 15) {
                let num = Math.floor(Math.random() * 25) + 1;
                if (!numbers.includes(num)) {
                    numbers.push(num);
                }
            }
            numbers.sort((a, b) => a - b);
            document.getElementById('lotofacil-numbers').innerHTML = 
                `N√∫meros aleat√≥rios: ${numbers.join(', ')}`;
        }
        
        // Fun√ß√£o para compress√£o de n√∫meros (simula√ß√£o)
        function compressNumbers() {
            let level = document.getElementById('compression-level').value;
            let results;
            switch(level) {
                case 'low':
                    results = 'Compress√£o simples: 1, 2, 3, 4, 5';
                    break;
                case 'medium':
                    results = 'Compress√£o m√©dia: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10';
                    break;
                case 'high':
                    results = 'Compress√£o alta: 1 a 15';
                    break;
            }
            document.getElementById('compression-results').innerHTML = results;
        }
        
        // Conex√£o em tempo real (simula√ß√£o)
        function updateConnectionStatus() {
            const statusElement = document.getElementById('connection-status');
            setTimeout(() => {
                statusElement.innerHTML = "Conectado!";
                statusElement.style.backgroundColor = "#4caf50";
                
                // Atualiza a data/hora
                const now = new Date();
                document.getElementById('last-update').innerText = 
                    `√öltima atualiza√ß√£o: ${now.toLocaleString()}`;
            }, 2000);
        }
        
        // Event listeners
        document.getElementById('train-model').addEventListener('click', trainModel);
        document.getElementById('analyze-patterns').addEventListener('click', predictWithModel);
        document.getElementById('generate-ai-numbers').addEventListener('click', generateNumbersWithAI);
        document.getElementById('generate-random-numbers').addEventListener('click', generateRandomNumbers);
        document.getElementById('compress-numbers').addEventListener('click', compressNumbers);
        
        // Inicializa a conex√£o em tempo real
        updateConnectionStatus();
    </script>
</body>
</html>
